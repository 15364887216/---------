个人学习计算机组成原理的理解笔记，仅供参考学习使用
# 第一章 计算机系统概论
## 计算机的发展
**计算机系统=硬件+软件**
- 硬件：计算机的实体如主机、外设（键盘、鼠标......）等
- 软件：由具有各类特殊功能的程序组成

计算机组成原理主要研究计算机硬件系统的基本结构和工作原理，计算机的硬件发展有一段很长的历史和发展过程，已经从考研大纲中删除，这一块我们快速过一下就好。
![硬件发展历史](/pictures/1/image1.png) 
![硬件发展历史](/pictures/1/image2.png) 
![硬件发展历史](/pictures/1/image3.png) 
![硬件发展历史](/pictures/1/image4.png) 
```
这里用的是王道考研408的截图，课程是免费的，可以去看一下。
```
**摩尔定律:** 揭示了信息技术进步的速度集成电路上可容纳的品体管数目，约每隔18个月便会增加一倍，整体性能也将提升一倍。

软件的发展过程可以分为以下几个阶段：

1. **机器语言和汇编语言**：
   - **机器语言**：最早的软件是用机器语言编写的，直接操作硬件。
   - **汇编语言**：随后出现了汇编语言，使用助记符来简化编程。

2. **高级语言的出现**：
   - **FORTRAN**：第一个实用的高级语言，主要用于科学和工程计算。
   - **PASCAL**：强调结构化程序设计，适合教学和系统编程。

3. **面向对象编程**：
   - **C++**：在C语言基础上增加了面向对象的特性。
   - **Java**：跨平台的面向对象语言，广泛用于互联网应用。

4. **操作系统的发展**：
   - **DOS**：早期的磁盘操作系统，主要用于个人计算机。
   - **Windows**：图形用户界面的操作系统，极大地普及了个人计算机的使用。

目前计算机的发展呈现两极分化的情况：
一极是向更**微型化、网络化、高性能、多用途方向**发展;
- 比如手机，智能手表

另一极是巨型机向更**巨型化、超高速、并行处理、智能化方向**发展。
- 超级计算机，比如中国的神威太湖之光。
  
```
当然这只是趋势，并不是说手机一定要越做越小，比如华为的三折叠emm
```
****
## 各个硬件的工作原理
在此之前要先了解一个封装的概念。
```
这里用的是Crash Course Computer Science的例子，放一个链接
【【计算机科学速成课】[40集全/精校] - Crash Course Computer Science】 https://www.bilibili.com/video/BV1EW411u7th/?share_source=copy_web&vd_source=ac577b966f2e9f3eeaecc61d44a9ddd9
```
**Crash Course Computer Science** 提到的封装概念主要包括以下几点：

- **抽象**：通过隐藏复杂的实现细节，只暴露必要的接口，使得使用者无需了解内部工作原理。
- **模块化**：将系统分解成独立的模块，每个模块负责特定功能，便于维护和更新。
- **信息隐藏**：保护数据不被外部直接访问，防止误操作和数据损坏。
- **接口**：定义模块之间的通信方式，确保模块可以独立开发和测试。

这些概念有助于提高代码的可读性、可维护性和可扩展性。

我们所研究的大部分计算机是***冯诺依曼结构***。

***冯诺依曼结构：*** 冯诺依曼结构（英语：Von Neumann architecture），也称冯诺依曼模型（Von Neumann model）或普林斯顿结构（Princeton architecture），是一种将程序指令存储器和数据存储器合并在一起的电脑设计概念结构。本词描述的是一种实现通用图灵机的计算设备，以及一种相对于并行计算的序列式结构参考模型（referential model）。

本结构隐约指导了将存储设备与中央处理器分开的概念，因此依本结构设计出的计算机又称存储程序计算机。(以上节选自维基百科)

通俗地说冯诺依曼结构由五个部分组成：**运算器、控制器、存储器、输入设备和输出设备**。
![冯诺依曼结构维基百科](/pictures/1/fnym2.png)
其中控制器（Control Unit）和运算器（Arithmetic/Logic Unit）合起来就是CPU（Central Processing Unit），输入输出设备就是我们常说的I/O设备。
```
虽然笔记整体跟着王道408的结构走，但是一部分我会选其他的课程或资料，方便记忆，比如这里的图我会用维基百科，后面主要的知识点会采用Crash Course Computer Science的内容讲解。
```
![冯诺依曼特点](/pictures/1/fnym3.png)

现在我们完整地过一遍现代计算机的运行过程，很简单。
在此之前我们要先了解，存储器按用途分类有**主存储器**（直接与CPU通信的存储器，如内存（RAM））和**外存储器**之分（用于长期存储数据，如硬盘、光盘等）
现代计算机的运行原理可以通过以下几个步骤来理解：

1. **输入**：
   - 计算机通过输入设备（如键盘、鼠标、传感器等）接收数据和指令。

2. **存储**：
   - 接收到的数据和指令被存储在计算机的内存中。内存可以是随机存取存储器（RAM）或只读存储器（ROM）。

3. **处理**：
   - 中央处理器（CPU）从内存中读取指令，并根据指令执行相应的操作。CPU包括运算器（ALU）和控制器（CU），前者负责算术和逻辑运算，后者负责指令的解码和执行。

4. **输出**：
   - 处理后的数据通过输出设备（如显示器、打印机等）呈现给用户。

5. **存储结果**：
   - 处理结果可以被存储在长期存储设备中，如硬盘、固态硬盘（SSD）等，以便后续使用。

具体来说，计算机的工作流程如下：

- **取指令**：CPU从内存中取出一条指令。
- **解码**：控制器对指令进行解码，确定需要执行的操作。
- **执行**：运算器执行指令所要求的操作，如算术运算、数据传输等。
- **存储结果**：将运算结果存储在内存或寄存器中。
- **输出结果**：将结果通过输出设备展示给用户。

这种流程不断循环，直到所有指令执行完毕。

在整个过程中，我们发现输入输出与处理之前总需要通过存储器，存储器占据工作的中心位置，因此我们说现代计算机***以存储器为中心***。
来两个PPT总结一下
![总结](/pictures/1/review1.png)
![总结](/pictures/1/review2.png)

## 各个硬件的工作原理
### 存储器
我们在聊计算机的工作原理的时候总是会类比我们的物流系统，比如计算机网络和计算机组成原理。

假设数据是你的包裹，我们将主存储器认为是快递驿站，比如我们的菜鸟驿站，取包裹，出示取件号，由店员或我们本人根据取件号取包裹并在柜台确认取件。

在这个例子中我们有两个需要注意的信息，**取件号**和**柜台**，这分别对应了我们存储器的两个**寄存器**，分别是**Memory Address Register(存储地址寄存器)**和**Memory Data Register(存储数据寄存器)**，保存着我们包裹（数据）的货架就像是存储体，将要读取的内存地址加载到MAR中，根据地址去找数据，然后将数据放在mdr中，这就完成了。
![存储器](/pictures/1/ccq.png)

### 运算器
运算器的运行较为复杂且后续有更详细的讲解，放张图先。
![运算器](/pictures/1/ysq.png)
因为第二章有原反补码的运算且涉及到数电的内容，这里只需要知道他有一个累加器，一个乘商寄存器，一个通用寄存器和***ALU***就好了，稍后会有计算机运行过程的讲解。

### 控制器
![控制器](/pictures/1/kzq.png)
控制器的运行过程很简单：
1.**PC（程序计数器）** 与存储器进行交互，将内存中的指令取出来交**IR（指令寄存器）** 后自动+1，以进行下一次操作。
2.**IR（指令寄存器）**对取出的指令进行解码，翻译成一系列微操作信号，这些信号指示CPU的其他部分该做什么。
3.**CU**分析微操作信号向CPU的其他部分比如 ***ALU***发送控制信号执行指令。

### 计算机的工作过程
现在我们将前面几个部分组合在一起，通过一段C++程序来进行分析计算机的工作过程。
```cpp
int a = 2,b = 3,c = 1,y = 0;

int main() {
	y = a * b + c;
}

```
我们知道编程语言经历了从机器语言到汇编语言再到高级语言的过程，但最后经过编译等过程都会变成机器语言，也就是一段二进制代码。我们假设每一段指令的长度有16bit长，也就是16个0或1,做一下简单的二进制转换，我们会得到。
- a = 0000000000000010
- b = 0000000000000011
- c = 0000000000000001
- y = 0000000000000000
我将代码的执行过程整理成一个表格：

| 步骤 | 操作                  | 结果      |
|------|-----------------------|-----------|
| 1    | 初始化变量：设定 `a` 为 2 | `a = 2`   |
| 2    | 初始化变量：设定 `b` 为 3 | `b = 3`   |
| 3    | 初始化变量：设定 `c` 为 1 | `c = 1`   |
| 4    | 初始化变量：设定 `y` 为 0 | `y = 0`   |
| 5    | 计算 `a * b`          | `2 * 3 = 6` |
| 6    | 将 `c` 加到结果中     | `6 + 1 = 7` |
| 7    | 将结果存储在 `y` 中   | `y = 7`   |

而操作指令同样是一个二进制代码，操作代码需要对指定地址的数据进行操作，因此操作码与地址码共同占据16个bit，比如：
假设变量a存储在地址为5的内存中，从地址5**取出**变量a，那么二进制代码应该为000001（取出）+000000000101（地址），以此类推。**我们设定将操作码优先放在靠前的地址中，具体的数据放在后面**，会得到这样一个表格。
![运行](/pictures/1/run.png)
现在我们从整体的角度看一下程序的运行过程，我们默认程序已经存入到主存储体中，且该程序无输出，因此忽略IO设备。
```
下图是我用processon自己画的，可以自己动手画一下。
```
![运行](/pictures/1/run1.png)
***
1.PC默认初始为0，地址从0开始，发送指令到MAR，MAR变为0，此时PC+1

![运行](/pictures/1/bz1.png)

2,3.MAR将地址传给存储体，获取地址为0的二进制代码并传给MDR，此时MDR = 0000010000000101

![运行](/pictures/1/run2.png)

4.MDR将指令发送给IR，此时IR = MDR =0000010000000101

![运行](/pictures/1/run4.png)

5，6.IR分析指令，将指令拆分，操作码发给CU，地址发给MAR，此时CU = 000001（取数到ACC） ，MAR = 000000000000000101（地址前空缺的部分补0） = 5

![运行](/pictures/1/run5.png)

7，8.CU发送控制信号到指定部位（该线省略，CU会将控制信号传给相应的硬件部件），同时重复2，3操作，此时MDR = a = 2（二进制省略）

![运行](/pictures/1/run7.png)

9.MDR将数据传给ACC，此时ACC = a = 2。第一条指令结束。
![运行](/pictures/1/run9.png)

10.PC+1后会执行第二条操作，即地址为1的指令，执行过程与上述类似，当然并不需要等到第一条指令全部结束才会执行第二条指令，这里要注意。

OK,现在我们整体地通过一条指令了解了计算机的执行过程。
![运行](/pictures/1/zx.png)
我们第二章就会涉及到加法和乘法操作，这里只是过一下。
![运行](/pictures/1/zx1.png)

![运行](/pictures/1/zx2.png)

***

## 计算机系统的多级层次结构
### 三种级别的语言
机器语言、汇编语言和高级语言是计算机程序设计的三个不同层次。下面我们以一个简单的例子来说明它们之间的关系。

1. **机器语言**
机器语言是计算机能直接理解的语言，由二进制数构成。假设我们要将两个数字相加，以下是一个简单的机器语言指令（假设这里是 x86 架构）：

```
10110000 01100001; 将数字 97 (ASCII 'a') 加载到寄存器
10110001 01100010; 将数字 98 (ASCII 'b') 加载到另一个寄存器
00000000 00000010; 加法操作
```

2. **汇编语言**
汇编语言是机器语言的助记符表示，便于人类理解。与机器语言相比，汇编语言使用的符号更容易记忆。上述机器语言指令可以用汇编语言表示为：

```assembly
MOV AL, 97; 将 97 加载到 AL 寄存器
MOV BL, 98; 将 98 加载到 BL 寄存器
ADD AL, BL; 将 AL 和 BL 的值相加，结果存储在 AL 中
```

3.**高级语言**
高级语言则更接近于自然语言，具有更高的抽象程度，通常不需要关心底层硬件的细节。以上的汇编指令可以用 C 语言表示为：

```c
#include <stdio.h>

int main() {
    char a = 'a'; // ASCII 97
    char b = 'b'; // ASCII 98
    char sum = a + b; // 计算 a 和 b 的和
    printf("Sum: %d\n", sum); // 打印结果
    return 0;
}
```

#### 总结
- **机器语言** 是计算机所理解的二进制代码，直接与硬件沟通。
- **汇编语言** 是机器语言的符号表示，使用助记符来提高可读性。
- **高级语言** 提供了更多的抽象，易于编写和维护，通常不需要考虑底层实现细节。

这种层次结构使得编程逐步变得更简单、更直观。

### 计算机系统的五大层次结构
计算机系统的五大层次结构：**微指令机器、机器语言机器、操作系统机器、汇编语言机器、高级语言机器**
我们从上而下开始依次进行理解说明。
1.M0（微指令机器）：
例如*ADD R1, R2*，这个微指令并不是一个程序，指的是上一部分cu指挥进行的一系列操作，涉及具体的高低电平变换等操作。

2.M1(传统机器)：
即使用机器语言（二进制指令）的机器，M0和M1为硬件部分，不涉及任何的软件操作，我们可以使用纸带，磁带等物理媒介对他进行操作,即最早的计算机操作。

3.M2(操作系统机器)：
操作系统在这一层次发挥作用，管理硬件资源和提供系统服务。通俗地讲，对下层操作进行包装，向上层提供广义上的可用指令，比如用汇编语言ADD可调用操作系统实现下层的一系列操作。

4.M3(汇编语言机器)：
- 功能：使用汇编语言编写程序，汇编器将其翻译成机器语言。
- 理解：汇编语言使用助记符代替机器语言中的二进制代码，更易于人类理解和编写，但仍然需要与硬件紧密结合。

5.M4（高级语言机器）：
- 功能：使用高级编程语言，如C、C++、Java等。编译器将高级语言翻译成汇编语言或机器语言。
- 理解：高级语言更接近人类语言，提供更高的抽象层次，使得编程更加简便和高效。编译器负责将高级语言代码转换为机器能够执行的低级代码。

![层次结构](/pictures/1/ccjg.png)

***

## 计算机的性能指标
### 存储器的性能指标
**存储容量**：表示存储器可以存储的数据量，通常以字节（Byte）、千字节（KB）、兆字节（MB）、千兆字节（GB）等单位表示。

我们知道计算机的数据以二进制0或1的形式存储，先来了解两个两个常用的单位，**bit（位）**和**byte（字节）**，bit就是0或1的个数，比如001就是3bit，比特（bit）和字节（byte）之间的换算非常简单：

- **1 字节（byte） = 8 比特（bits）**。

所以，如果你有一个字节的数据，它就等于8个比特。同样地，如果你有比特的数据量，可以通过除以8来转换为字节。例如：

- **16 比特 = 16 / 8 = 2 字节**。

很多人疑惑为什么这么换算，由于二进制的关系，计算机的很多数据都2的倍数来换算。比如2，4，8，16。字节那当然和一个字有关系啦。我们常用的ASCLL编码标准规定1个字符用8位来表示，这样我们就可以在 计算机中使用a，b，c等英文字符或者其他字符啦！
当然这也与硬件或者其他的因素有关，比如我们表示颜色使用的RGB采用256这个标准，也就是2的8次方，正好是8位能表示的，计算机有很多是约定俗成的东西，你当然可以使用16或者32等标准来作为字节，不要太纠结。

计算存储器所能存储数字的大小可以利用MAR和MDR的数值来计算，MAR的最大值+1表示地址的个数（因为地址是从0开始的），MDR的位数表示一个地址能表示多少位或多少字节的数据。两者相乘就是存储器的存储量了，他的性能当然是越大越好啦！

![存储器性能](/pictures/1/ccqxn.png)
存储器的性能指标主要包括以下几个方面：



### CPU的性能指标
我们知道一条指令的执行是有周期的，其他条件相同的前提下，一个周期的时间越短，频率越快，CPU越好。
![CPU性能](/pictures/1/cpu1.png)

![CPU性能](/pictures/1/cpu2.png)

![CPU性能](/pictures/1/cpu3.png)
```
注意cpu与存储器K,M,G进制的差别，存储器存储用二进制。
因此kb指的是2的10次方，即1024bit，Mb指的是2的20次方......
同时注意b和B的区别，一个是bit，一个是byte。
cpu计算时间采用的是10进制，即千，百万，十亿......
```